    - name: get back device associated to mountpoint
      shell: mount | grep ' /var/tmp ' |cut -d ' ' -f 1
      register: device_name
      check_mode: no
      tags:
        - mount_option_var_tmp_nodev
        - unknown_severity
        - configure_strategy
        - low_complexity
        - high_disruption
    
    - name: get back device previous mount option
      shell: mount | grep ' /var/tmp ' | sed -re 's:.*\((.*)\):\1:'
      register: device_cur_mountoption
      check_mode: no
      tags:
        - mount_option_var_tmp_nodev
        - unknown_severity
        - configure_strategy
        - low_complexity
        - high_disruption
    
    - name: get back device fstype
      shell: mount | grep ' /var/tmp ' | cut -d ' ' -f 5
      register: device_fstype
      check_mode: no
      tags:
        - mount_option_var_tmp_nodev
        - unknown_severity
        - configure_strategy
        - low_complexity
        - high_disruption
    
    - name: Ensure permission nodev are set on /var/tmp
      mount:
        path: "/var/tmp"
        src: "{{device_name.stdout}}"
        opts: "{{device_cur_mountoption.stdout}},nodev"
        state: "mounted"
        fstype: "{{device_fstype.stdout}}"
      tags:
        - mount_option_var_tmp_nodev
        - unknown_severity
        - configure_strategy
        - low_complexity
        - high_disruption
    
    - name: XCCDF Value var_removable_partition # promote to variable
      set_fact:
        var_removable_partition: !!str |-
            /dev/cdrom
      tags:
        - always